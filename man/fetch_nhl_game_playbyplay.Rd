% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fetch_nhl_playbyplay.R
\name{fetch_nhl_game_playbyplay}
\alias{fetch_nhl_game_playbyplay}
\title{Fetch NHL game play-by-play data using ESPN API}
\usage{
fetch_nhl_game_playbyplay(event_id, return_type = "all", raw = FALSE)
}
\arguments{
\item{event_id}{Character or Numeric. ESPN event ID (required).
The unique identifier for the game in ESPN's database.}

\item{return_type}{Character. Type of data to return (default: "all").
Options are:
\itemize{
\item "game_summary" - Basic game information and totals
\item "period_summary" - Period-by-period scoring summary
\item "plays" - Individual play-by-play data
\item "all" - All data types combined
}}

\item{raw}{Logical. If TRUE, assigns raw JSON response to global environment
as 'nhl_pbp_raw' for debugging purposes (default: FALSE).}
}
\value{
Invisibly returns the processed data. The main purpose is global
environment assignment based on return_type:
\itemize{
\item \code{nhl_pbp_game_summary} - Game summary data frame
\item \code{nhl_pbp_period_summary} - Period summary data frame
\item \code{nhl_pbp_plays} - Complete plays data frame with all ESPN fields
\item \code{nhl_pbp_raw} - Raw JSON response (if raw = TRUE)
}
}
\description{
Retrieves detailed play-by-play information from ESPN's NHL API.
The function fetches comprehensive play data for a specific NHL game.
}
\details{
The function creates structured data frames with comprehensive play-by-play information:

\strong{Game Summary} (\code{nhl_pbp_game_summary}):
\itemize{
\item Game details: event_id, game_date, game_status, season info
\item Team matchup: home_team vs away_team with final scores
\item Venue, attendance, and total plays/periods information
}

\strong{Period Summary} (\code{nhl_pbp_period_summary}):
\itemize{
\item Period-by-period scoring breakdown (1st, 2nd, 3rd, OT, SO)
\item Goals scored per period
\item Play counts per period
\item Running score after each period
}

\strong{Plays} (\code{nhl_pbp_plays}):
\itemize{
\item Complete ESPN plays data frame with all 25+ columns preserved
\item Nested data frames: period, type, participants, coordinate, etc.
\item Shot tracking: coordinates, shot type, save/goal details
\item Penalty data: infraction type, duration, player details
\item Faceoff tracking: zone, winner details
\item Game situation: score, time remaining, strength
}

\strong{Rich Data Access Examples}:
\itemize{
\item \code{nhl_pbp_plays$shotType$text} - Shot type (wrist shot, slap shot, etc.)
\item \code{nhl_pbp_plays$participants} - Player details for each play
\item \code{nhl_pbp_plays$coordinate} - Play location coordinates (x,y)
\item \code{nhl_pbp_plays$strength$abbreviation} - Game strength (EV, PP, SH)
\item \code{nhl_pbp_plays$penaltyType$text} - Penalty infraction details
}
}
\examples{
\dontrun{
# Get complete play-by-play for a specific game
fetch_nhl_game_playbyplay(event_id = "401589281")

# Check what data was created
head(nhl_pbp_game_summary)
head(nhl_pbp_period_summary)
head(nhl_pbp_plays)

# Access nested data structures
nhl_pbp_plays$period$number          # Period numbers
nhl_pbp_plays$shotType$text          # Shot type names
nhl_pbp_plays$coordinate$x           # Play location X

# Get only plays data
fetch_nhl_game_playbyplay(event_id = "401589281", return_type = "plays")

# Analyze power play goals
pp_goals <- nhl_pbp_plays[
  nhl_pbp_plays$scoringPlay == TRUE &
  nhl_pbp_plays$strength$abbreviation == "PP" &
  !is.na(nhl_pbp_plays$strength$abbreviation),
]

# Find all penalty plays
penalties <- nhl_pbp_plays[
  nhl_pbp_plays$type$text == "Penalty",
  c("text", "penaltyType", "participants")
]

# Analyze shot locations for goals
goals_with_coords <- nhl_pbp_plays[
  nhl_pbp_plays$scoringPlay == TRUE &
  !is.na(nhl_pbp_plays$coordinate$x) &
  !is.na(nhl_pbp_plays$coordinate$y),
]

# Faceoff analysis by zone
faceoffs <- nhl_pbp_plays[
  nhl_pbp_plays$type$text == "Faceoff",
  c("text", "coordinate", "participants")
]

# Power play opportunities
power_plays <- nhl_pbp_plays[
  nhl_pbp_plays$strength$abbreviation \%in\% c("PP", "SH") &
  !is.na(nhl_pbp_plays$strength$abbreviation),
]

# Get raw data for debugging
fetch_nhl_game_playbyplay(event_id = "401589281", raw = TRUE)
}

}
